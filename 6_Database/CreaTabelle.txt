
CREATE TABLE IF NOT EXISTS bus(
	id INT PRIMARY KEY AUTO_INCREMENT,
	posti_totali INT,
	numero_bus INT
);

CREATE TABLE IF NOT EXISTS utente (
	id INT AUTO_INCREMENT PRIMARY KEY,
	nome VARCHAR(25) NOT NULL,
	cognome VARCHAR(25) NOT NULL,
	password VARCHAR(25) NOT NULL,
	email VARCHAR(50) NOT NULL
);

CREATE TABLE IF NOT EXISTS posto (
	id INT AUTO_INCREMENT PRIMARY KEY,
	id_bus INT NOT NULL,
	id_utente INT NOT NULL,
	numero_posto INT NOT NULL,
	FOREIGN KEY (id_bus)
	REFERENCES bus (id)
	ON DELETE CASCADE,
	FOREIGN KEY (id_utente)
	REFERENCES utente (id)
	ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS viaggio(
	id INT PRIMARY KEY AUTO_INCREMENT,
	id_bus INT,	
	orario_partenza DATE,
	orario_arrivo DATE,
	localita_partenza VARCHAR(50),
	localita_arrivo VARCHAR(50),
	FOREIGN KEY(id_bus) REFERENCES bus(id)
	ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS tappa(
	id INT PRIMARY KEY AUTO_INCREMENT,
	id_viaggio INT,	
	localita_partenza VARCHAR(50),
	localita_arrivo VARCHAR(50),
	orario_partenza DATE,
	orario_arrivo DATE,
	costo FLOAT,
	numero_tappa INT,
	FOREIGN KEY(id_viaggio) REFERENCES viaggio(id)
	ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS biglietto (
	id INT AUTO_INCREMENT PRIMARY KEY,
	id_viaggio INT NOT NULL,
	id_utente INT NOT NULL,
	costo_totale INT NOT NULL,
	FOREIGN KEY (id_viaggio)
	REFERENCES viaggio (id)
	ON DELETE CASCADE,
	FOREIGN KEY (id_utente)
	REFERENCES utente (id)
	ON DELETE CASCADE
);

INSERT INTO utente (nome, cognome, password, email) VALUES('Marco', 'Rossi', 'pass', 'Marco.Rosi@gmail.com');
INSERT INTO utente (nome, cognome, password, email) VALUES('Giacomo', 'Verdi', 'pass', 'Giacomo.Verdi@gmail.com');
INSERT INTO utente (nome, cognome, password, email) VALUES('Lorenzo', 'Bianchi', 'pass', 'Lorenzo.Bianchi@gmail.com');





INSERT INTO bus(posti_totali, numero_bus) VALUES(20, 1);



INSERT INTO viaggio(id_bus, localita_partenza, localita_arrivo, orario_partenza, orario_arrivo) VALUES(1, "Lugano", "Taverne", "08:00:00" , "08:10:00");

INSERT INTO tappa(id_viaggio, localita_partenza, localita_arrivo, orario_arrivo, orario_partenza, costo, numero_tappa) VALUES(1, "08:00:00", "08:05:00", "Lugano", "Lamone", 2.00 ,1);
INSERT INTO tappa(id_viaggio, localita_partenza, localita_arrivo, orario_arrivo, orario_partenza, costo, numero_tappa) VALUES(1, "08:05:00", "08:10:00", "Lamone", "Taverne", 2.00 ,2 );

INSERT INTO bus(posti_totali, numero_bus) VALUES(40, 2);

INSERT INTO viaggio(id_bus, localita_partenza, localita_arrivo, orario_partenza, orario_arrivo) VALUES(2, "Mendrisio", "Lugano", "12:00:00", "12:30:00");

INSERT INTO tappa(id_viaggio, localita_partenza, localita_arrivo, orario_arrivo, orario_partenza, costo, numero_tappa) VALUES(2, "12:00:00", "12:15:00", "Mendrisio", "Melide", 2.00 ,1 );
INSERT INTO tappa(id_viaggio, localita_partenza, localita_arrivo, orario_arrivo, orario_partenza, costo, numero_tappa) VALUES(2, "12:15:00", "12:30:00", "Melide", "Lugano", 2.00 ,2 );


INSERT INTO bus(posti_totali, numero_bus) VALUES(60, 3);



INSERT INTO viaggio(id_bus, localita_partenza, localita_arrivo, orario_partenza, orario_arrivo) VALUES(3, "Chiasso", "Lamone", "15:00:00", "15:35:00");


INSERT INTO tappa(id_viaggio, localita_partenza, localita_arrivo, orario_arrivo, orario_partenza, costo, numero_tappa) VALUES(3, "15:00:00", "15:30:00", "Chiasso", "Lugano", 2.00 ,1 );
INSERT INTO tappa(id_viaggio, localita_partenza, localita_arrivo, orario_arrivo, orario_partenza, costo, numero_tappa) VALUES(3, "15:30:00", "15:35:00", "Lugano", "Lamone", 2.00 ,2 );

INSERT INTO posto(id_bus, id_utente, numero_posto) VALUES(3, 3, 5);
INSERT INTO posto(id_bus, id_utente, numero_posto) VALUES(1, 2, 7);
INSERT INTO posto(id_bus, id_utente, numero_posto) VALUES(2, 1, 30);

INSERT INTO biglietto(id_viaggio, id_utente, costo_totale) VALUES(2, 1, 50);
INSERT INTO biglietto(id_viaggio, id_utente, costo_totale) VALUES(3, 2, 20);
INSERT INTO biglietto(id_viaggio, id_utente, costo_totale) VALUES(1, 3, 25);


